## 什么是TCP协议

TCP（Transmission Control Protocol 传输控制协议）是一种面向连接的、可靠的、基于字节流的传输层通信协议。为了提供可靠性传输，实行**顺序控制**和**重发控制**等机制。在计算机网络OSI模型中，他完成了传输层（第四层）的工作。

## TCP包的头部

![TCP包头部](https://static001.geekbang.org/resource/image/a7/bf/a795461effcce686a43f48e094c9adbf.jpg)

- 源端口号（16位）、目标端口号（16位）
> 各占用16位字节，表示发送端端口号和接收端端口号。这端口号加上IP首部中的源端IP地址和目的端IP地址就能唯一确定一个TCP的连接。

- 序号 - 发送数据的顺序编号（32位）
> 占用32位字节，序号用来标识从TCP发送端向TCP接受端发送的数据字节流, 它表示在这个报文段中的第一个数据字节在数据流中的位置。

- 确认应答号（ACK 号）- 接收数据的顺序编号（32位）
> 表示了接收方告知发送方接收方已经收到了所有数据的第几个字节。

- 首部长度（数据偏移量）（4位）
> 占用4位字节，表示了TCP传输的数据部分应该从TCP包的哪个位开始计算。也表示了TCP包首部长度。

- 保留（4位）
> 占用4位字节，该字段为保留，为以后扩展使用，现在未使用。

- 控制位（6位）

该字段中的每个比特分别表示以下通信控制含义。

> - URG: 表示紧急指针字段有效

> - ACK: 表示接收数据序号字段有效，为1时表示数据已被接收方收到，为0时没有收到。

> - PSH: 表示通过push操作发送的数据，为1的时候接收方收到数据立马上传给上层应用协议，为0的时候不是立马上传而是先缓存起来

> - RST: 强制断开连接,用于异常中断的情况

> - SYN: 发送方和接收方相互确认序号,表示连接 操作

> - FIN: 表示断开连接

- 窗口（16位）
- 校验和（16位）
- 紧急指针（16位）
- 选项（长度可变）
- 紧急指针（16位）